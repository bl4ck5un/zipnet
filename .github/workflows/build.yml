name: Build
on: push

jobs:
  build-enclave:
    runs-on: ubuntu-18.04
    container:
      image: baiduxlab/sgx-rust:1804-1.1.3
      env:
        SGX_MODE: SW
        SGX_SDK: /opt/sgxsdk
    steps:
      - uses: actions/checkout@v2
      - name: Build enclave
        run: bash -c "cd prototype/enclave && export PATH=.root/.cargo/bin:$PATH make"
      - name: Build client
        run: bash -c "cd prototype/client && export PATH=.root/.cargo/bin:$PATH cargo b"